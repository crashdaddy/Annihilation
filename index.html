<!DOCTYPE html><html>	<head>		<title>Crazy Happy Fun Annihilation</title>	<body><font size = "6"><u><b>Happy Crazy Space Fight</b></u></font><br />This game is written in Javascript using HTML5. Use the mouse button to aimand shoot, and the WASD keys to move your ship around!<br />Now works in all major browsers (except IE11 doesn't play sounds--but who cares, right?)<br />PS: "M" key <b>mutes</b> sounds.<br /><p><script src="js/phaser.js"></script>		<script>					var game = new Phaser.Game(1000, 600, Phaser.CANVAS, null, { preload: preload, create: create, update: update, render: render });var gameRunning = false;var sprite;var bullets;var aliens;var pew;var shot;var crash;var shipHit;var lifeLost;var muted = false;var score;var scoreBuffer;var keyLeft;var keyRight;var keyUp;var keyDown;var lives;var fireRate = 100;var nextFire = 0;var healthBar;function preload() {    game.load.image('arrow', 'img/ship.png');    game.load.image('bullet', 'img/shot.png');    game.load.image('spaceBG','img/space2.png');    game.load.image('alien','img/alien.png');    game.load.spritesheet('explosion', 'img/explode.png', 128, 128);    game.load.image('greenHealthBar', 'img/healthbar_green.png');    game.load.image('redHealthBar', 'img/healthbar_red.png');    game.load.audio('pew', 'img/pew.wav');    game.load.audio('shot', 'img/blop.wav');    game.load.audio('crash', 'img/crash.mp3');    game.load.audio('lifeLost', 'img/mirror.wav');}function create() {    cursors = game.input.keyboard.createCursorKeys();    muteKey = game.input.keyboard.addKey(Phaser.Keyboard.M);    muteKey.onDown.add(toggleMute, this);    keyLeft = game.input.keyboard.addKey(Phaser.Keyboard.A);    keyRight = game.input.keyboard.addKey(Phaser.Keyboard.D);    keyUp = game.input.keyboard.addKey(Phaser.Keyboard.W);    keyDown = game.input.keyboard.addKey(Phaser.Keyboard.S);    game.add.sprite(0,0,'spaceBG');    var me = this;    score = 0;    scoreBuffer = 0;    createScore();    game.physics.startSystem(Phaser.Physics.ARCADE);    bullets = game.add.group();    bullets.enableBody = true;    bullets.physicsBodyType = Phaser.Physics.ARCADE;    bullets.createMultiple(50, 'bullet');    bullets.setAll('checkWorldBounds', true);    bullets.setAll('outOfBoundsKill', true);     aliens = game.add.group();    aliens.enableBody = true;    aliens.physicsBodyType = Phaser.Physics.ARCADE;    aliens.createMultiple(40,'alien');    aliens.setAll('checkWorldBounds',true);    aliens.setAll('outOfBoundsKill',false);         sprite = game.add.sprite(400, 300, 'arrow');    sprite.anchor.set(0.5);    sprite.health = 100;    sprite.maxHealth = 100;    var backgroundBar = game.add.image(400,20,'redHealthBar');    backgroundBar.fixedToCamera = true;    healthBar = game.add.image(400,20, 'greenHealthBar');    healthBar.fixedToCamera = true;    var healthLabel = game.add.text(310, 20, 'Shields:', {fontSize:'20px', fill:'#ffffff'});    healthLabel.fixedToCamera = true;    game.physics.enable(sprite, Phaser.Physics.ARCADE);    sprite.body.allowRotation = true;    //  Text    stateText = game.add.text(game.world.centerX,game.world.centerY,'Annihilation!', { font: '84px Arial', fill: '#f00' });    stateText.anchor.setTo(0.5, 0.5);       stateText.visible = true;    game.add.tween(stateText).to({alpha: 0}, 3000, Phaser.Easing.Cubic.Out, true, 500);    game.add.tween(stateText.scale).to({x: 4, y: 4}, 3000, Phaser.Easing.Cubic.Out, true, 500);    //  Lives    lives = game.add.group();    for (var i = 0; i < 3; i++)     {        var extraShip = lives.create(game.world.width - 100 + (30 * i), 60, 'arrow');        extraShip.anchor.setTo(0.5, 0.5);        extraShip.angle = 90;        extraShip.alpha = 0.4;    }        createAliens();    game.camera.follow(sprite, Phaser.Camera.FOLLOW_LOCKON, 0.1, 0.1);    pew = game.add.audio('pew');    shipHit = game.add.audio('crash');    shot = game.add.audio('shot');    lifeLost = game.add.audio('lifeLost');}function createScore(){       var me = this;        var scoreFont = "80px Arial";        //Create the score label        me.scoreLabel = me.game.add.text(800, 20, "0", {font: scoreFont, fill: "#ffff00", stroke: "#535353", strokeThickness: 15});         me.scoreLabel.anchor.setTo(0.5, 0);        me.scoreLabel.align = 'center';        //Create a tween to grow / shrink the score label        me.scoreLabelTween = game.add.tween(me.scoreLabel.scale).to({ x: 1.5, y: 1.5}, 200, Phaser.Easing.Linear.In).to({ x: 1, y: 1}, 200, Phaser.Easing.Linear.In);   }function toggleMute() {  if (!muted) {   muted = true;} else {   muted=false;}}function createAliens () {    for (var i = 0; i < 40; i++)    {            aliens.create( Math.random() * game.width, Math.random() * game.height, 'alien');                }    //  All this does is basically start the invaders moving. Notice we're moving the Group they belong to, rather than the invaders directly.    //var tween = game.add.tween(aliens).to( { sprite.x }, sprite.y, Phaser.Easing.Linear.None, true, 0, 1000, true);    //  When the tween loops it calls descend   // tween.onLoop.add(descend, this);}function restart () {    //  A new level starts        //resets the life count    lives.callAll('revive');    //  And brings the aliens back from the dead :)    aliens.removeAll();    createAliens();    score=0;    scoreBuffer=0;    scoreLabel.text = "0";    //revives the player    sprite.revive();    //hides the text    stateText.visible = false;}function update() {if (gameRunning) {    sprite.rotation = game.physics.arcade.angleToPointer(sprite);    if (game.input.activePointer.isDown)    {        fire();    }    if(keyLeft.isDown) {	sprite.x -= 2;				    }    if(keyRight.isDown) {	sprite.x += 2;    }    if(keyUp.isDown) {	sprite.y -= 2;    }    if(keyDown.isDown) {	sprite.y += 2;   }aliens.forEach(function (alien) {    // add code to perform for each member    alien.x += 2;    if (alien.x > game.width) {    alien.x = 0;    alien.y = Math.random() * game.height;    adjustHealth(-1);    }game.physics.arcade.overlap(sprite, alien, collisionHandler);bullets.forEach(function (bullet) {game.physics.arcade.overlap(bullet, alien, alienShot);}); var me = this;        //While there is score in the score buffer, add it to the actual score       if(scoreBuffer > 0){           incrementScore();           scoreBuffer--;        }});} else {game.input.onTap.addOnce(function() { gameRunning=true;}, this);}}function createScoreAnimation(x, y, message, score){ var me = this;        var scoreFont = "45px Arial";        //Create a new label for the score        var scoreAnimation = me.game.add.text(x, y, message, {font: scoreFont, fill: "#39d179", stroke: "#ffffff", strokeThickness: 15});         scoreAnimation.anchor.setTo(0.5, 0);        scoreAnimation.align = 'center';        //Tween this score label to the total score label        var scoreTween = me.game.add.tween(scoreAnimation).to({x:800, y: 20}, 800, Phaser.Easing.Exponential.In, true);        //When the animation finishes, destroy this score label, trigger the total score labels animation and add the score        scoreTween.onComplete.add(function(){            scoreAnimation.destroy();            me.scoreLabelTween.start();            me.scoreBuffer += score;        }, me);    }function incrementScore(){        var me = this;            //Increase the score by one and update the total score label text        me.score += 1;          me.scoreLabel.text = me.score;      }function alienShot (bulletObject, alienObject) {    alienObject.x = 0;    alienObject.y = Math.random() * game.height;    if (!muted) { shot.play(); }    var newScore = game.rnd.integerInRange(1, 100);    createScoreAnimation(bulletObject.x, bulletObject.y, '+'+newScore, newScore);}function collisionHandler(shipObject, alienObject) {    game.camera.shake(0.01, 100, true, Phaser.Camera.SHAKE_BOTH, true);    if (!muted) { shipHit.play();}    adjustHealth(-10);    alienObject.x = 0;    alienObject.y = Math.random() * game.height;}function adjustHealth(healthAmount) { if (sprite.health > 0) {    sprite.health += healthAmount;    healthBar.scale.setTo(sprite.health / sprite.maxHealth, 1);} if (sprite.health <= 0) {   live = lives.getFirstAlive();    if (live)    {        live.kill();        var explosion = game.add.sprite(live.x, live.y, 'explosion');        explosion.anchor.setTo(0.5, 0.5);        var explode = explosion.animations.add('fire');        explosion.animations.play('fire', 30, false);	//explosion.destroy();	if (!muted) {lifeLost.play();}        sprite.health = 100;        healthBar.scale.setTo(sprite.health / sprite.maxHealth, 1);}}if (lives.countLiving() < 1)    {        sprite.kill();        aliens.callAll('kill');        stateText.text=" GAME OVER \n >>restart<<";        stateText.visible = true;        game.add.tween(stateText).to({alpha: 1}, 3000, Phaser.Easing.Cubic.Out, true, 500);        game.add.tween(stateText.scale).to({x: 1, y: 1}, 3000, Phaser.Easing.Cubic.Out, true, 500);	var timer = game.time.now + 3000        //the "click to restart" handler       gameRunning = false;       game.input.onTap.addOnce(restart,this);      // game.time.events.add(Phaser.Timer.SECOND * 3, gameOverMan, this);    }}function fire() {    if (game.time.now > nextFire && bullets.countDead() > 0)    {        nextFire = game.time.now + fireRate;	if (!muted) { pew.play();}        var bullet = bullets.getFirstDead();        bullet.reset(sprite.x - 8, sprite.y - 8);        game.physics.arcade.moveToPointer(bullet, 300);    }}function render() {    game.debug.text('Active Bullets: ' + bullets.countLiving() + ' / ' + bullets.total, 32, 32);    game.debug.spriteInfo(sprite, 32, 450);}		</script>	</head>	</body></html>